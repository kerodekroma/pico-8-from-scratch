pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()
 scenes={
  {
   id="welcome",
   x=0,
   y=0,
   upd_fn=nil,
   drw_fn=nil,
  },
  {
   id="gameplay",
   x=16,
   y=0,
   upd_fn=nil,
   drw_fn=nil
  }
 }
 current_scene = scenes[1].id
 -- storing the upd and draw
 -- methods in the scenes table
 _init_welcome()
 _init_gameplay()
 
 scene_data = get_scene_data(current_scene)  
end

function _update()
  local scene_data = get_scene_data(current_scene)
  if scene_data.upd_fn then
    scene_data.upd_fn()
  end
end

function _draw()
 cls()
 -- 1st way using camera
 -- 1st scene:
 -- camera(0,0)
 -- 2nd scene:
 -- camera(128,0)
 
 -- 2nd way
 -- 1st scene
 -- map(0,0,0,0,128)
 -- 2nd scene
 -- map(16,0,0,0,128)
 local scene_data = get_scene_data(current_scene)
 if scene_data.drw_fn then
   scene_data.drw_fn()
 end

 print("current_scene: "..current_scene)
end
-->8
-- scenes
function get_scene_data(id)
 local result = {}
 for i=1,#scenes do
   local scene = scenes[i]
   if scene.id == id then
     result = scene
   end 
 end
 return result
end

-- welcome scene
function _init_welcome()
 scenes[1].upd_fn=_update_welcome
 scenes[1].drw_fn=_draw_welcome
end

function _update_welcome() 
 if btnp(❎) then
   current_scene = scenes[2].id
 end
end

function _draw_welcome()
  map(0,0,0,0,128)
end

-- gameplay scene
function _init_gameplay()
  scenes[2].upd_fn=_update_gameplay
  scenes[2].drw_fn=_draw_gameplay
  gameplay_map_x1 = 16
  gameplay_map_y1 = 0
  -- player  
  _init_player(
	  gameplay_map_x1,
	  gameplay_map_y1
	 )
end

function _update_gameplay() 
 --if btnp(❎) then
 -- 	current_scene = scenes[1].id
	--end
	_update_player(
	 gameplay_map_x1,
	 function()
	   current_scene = scenes[1].id
	 end
	)
end


function _draw_gameplay()
 map(gameplay_map_x1,0,0,0,128)
 -- player
 _draw_player()
end

-->8
-- player
function _init_player()
 player={
  frame=22,
  x=2,
  y=2
 }
end

function _update_player(
  map_x1,
  on_touches_door)
  local new_x = player.x  
  local new_y = player.y
    
  if btnp(➡️) then new_x +=1 end
  if btnp(⬅️) then new_x -=1 end
  if btnp(⬆️) then new_y -=1 end
  if btnp(⬇️) then new_y +=1 end

  if is_the_door(map_x1+new_x, new_y) then
    on_touches_door()
  end
  
  -- adding bounds
  player.x = mid(0,new_x,15)
  player.y = mid(0,new_y,15)
end


function _draw_player()
 spr(player.frame,
 player.x*8,
 player.y*8)
end

-->8
-- some logic
function is_the_door(x,y)
  local door_frame = {
  	17
  }
  local tile = mget(x,y)
  for i=1,#door_frame do
    if tile == door_frame[i] then
     return true
    end
  end
  return false
end
__gfx__
0000000022222222cccccccc99999999444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000022222222cccccccc99999999444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070022222222cccccccc99999999444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700022222222cccccccc99999999444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0007700022222222cccccccc99999999444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070022222222cccccccc99999999444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000022222222cccccccc99999999444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000022222222cccccccc99999999444444440000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000099999999aaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
00000000888888880000000000000000000000000000000090000009a000000a0000000000000000000000000000000000000000000000000000000000000000
00000000889999880000000000000000000000000000000090000009a000000a0000000000000000000000000000000000000000000000000000000000000000
00000000889889880000000000000000000000000000000090000009a000000a0000000000000000000000000000000000000000000000000000000000000000
00000000889889880000000000000000000000000000000090000009a000000a0000000000000000000000000000000000000000000000000000000000000000
00000000889999880000000000000000000000000000000090000009a000000a0000000000000000000000000000000000000000000000000000000000000000
00000000898888880000000000000000000000000000000090000009a000000a0000000000000000000000000000000000000000000000000000000000000000
00000000888888890000000000000000000000000000000099999999aaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
__map__
0303030101010101010101010103030304040402020202020202020202040404060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0301010101010101010101010101010304020202020202020202020202020204060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0301010101010101010101010101010304020202020202020202020202020204060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010102020202020202020202020202110202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101010101010102020202020202020202020202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010103010101010101010102020202020404040404040202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010103010101010101010102020202020202020202040202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010103010101010101010102020202020202020202040202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010103010101010101010102020202020404040404040202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010103010101010101010102020202020402020202020202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010103010101010101010102020202020402020202020202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010103010101010101010102020202020404040404040202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0101010101010101010101110101010102020202020202020202020202020202060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0301010101010101010101010101010304020202020202020202020202020204060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0301010101010101010101010101010304020202020202020202020202020204060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0303030101010101010101010103030304040402020202020202020202040404060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0505050505050505050505050505050505050505050505050505050505050505050500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
